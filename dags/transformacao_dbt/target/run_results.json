{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2025-12-07T19:25:32.567102Z", "invocation_id": "eacfc0fc-6f58-4b70-925f-0cf8c27d29b8", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-07T19:25:28.965274Z", "completed_at": "2025-12-07T19:25:29.137659Z"}, {"name": "execute", "started_at": "2025-12-07T19:25:29.163270Z", "completed_at": "2025-12-07T19:25:32.198516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.315272331237793, "adapter_response": {"_message": "SELECT 7", "code": "SELECT", "rows_affected": 7}, "message": "SELECT 7", "failures": null, "unique_id": "model.projeto_boticario.vendas_analiticas", "compiled": true, "compiled_code": "/*\r\n    Aqui pegamos a tabela bruta que o Python criou (vendas_bronze)\r\n    e aplicamos regras de neg\u00f3cio.\r\n*/\r\n\r\nWITH vendas_brutas AS (\r\n    -- O dbt recomenda usar 'source' ou 'ref', mas vamos simplificar usando o nome direto\r\n    SELECT * FROM public.vendas_bronze\r\n)\r\n\r\nSELECT\r\n    id_pedido,\r\n    cliente,\r\n    produto,\r\n    categoria,\r\n    valor,\r\n    data_venda,\r\n    status_entrega,\r\n    -- Regra de Neg\u00f3cio 1: Categorizar valor do pedido\r\n    CASE \r\n        WHEN valor > 200 THEN 'Premium'\r\n        WHEN valor > 150 THEN 'Padr\u00e3o'\r\n        ELSE 'B\u00e1sico'\r\n    END AS classe_pedido,\r\n    -- Regra de Neg\u00f3cio 2: Flag de problema log\u00edstico (Isso o Botic\u00e1rio ama)\r\n    CASE \r\n        WHEN status_entrega IN ('Atrasado', 'Cancelado') THEN true\r\n        ELSE false\r\n    END AS teve_problema\r\nFROM vendas_brutas", "relation_name": "\"airflow\".\"public\".\"vendas_analiticas\""}], "elapsed_time": 5.796496629714966, "args": {"favor_state": false, "populate_cache": true, "print": true, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "select": [], "log_format_file": "debug", "use_colors_file": true, "project_dir": "/opt/airflow/dags/transformacao_dbt", "version_check": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "printer_width": 80, "use_colors": true, "cache_selected_only": false, "enable_legacy_logger": false, "invocation_command": "dbt run --project-dir /opt/airflow/dags/transformacao_dbt --profiles-dir /opt/airflow/dags/transformacao_dbt", "log_level": "info", "defer": false, "quiet": false, "strict_mode": false, "show_resource_report": false, "static_parser": true, "log_path": "/opt/airflow/dags/transformacao_dbt/logs", "which": "run", "vars": {}, "profiles_dir": "/opt/airflow/dags/transformacao_dbt", "partial_parse": true, "introspect": true, "indirect_selection": "eager", "log_format": "default", "partial_parse_file_diff": true, "macro_debugging": false, "write_json": true}}